version: 2

sources:
  - name: integrationtests
    description: "Fuente de datos para pruebas de integración en el entorno de desarrollo"
    database: "ct_maptech_{{env_var('DBT_ENVIRONMENT')}}_silver"
    freshness:
      warn_after: { count: 1, period: day }
      error_after: { count: 2, period: day }
    loaded_at_field: ingestion_date
    tables:
      - name: users
        description: "Tabla de usuarios del sistema con información personal, de contacto y actividad"
        columns:
          - name: user_id
            data_type: number
            description: "Identificador único del usuario, clave primaria de la tabla"
            tests:
              - unique
              - not_null
          - name: username
            data_type: varchar
            description: "Nombre de usuario único para autenticación en el sistema"
            tests:
              - not_null
          - name: email
            data_type: varchar
            description: "Dirección de correo electrónico única del usuario"
            tests:
              - unique
              - not_null
          - name: first_name
            data_type: varchar
            description: "Nombre del usuario"
            tests:
              - not_null
          - name: last_name
            data_type: varchar
            description: "Apellido del usuario"
            tests:
              - not_null
          - name: date_of_birth
            data_type: date
            description: "Fecha de nacimiento del usuario"
          - name: phone_number
            data_type: varchar
            description: "Número de teléfono del usuario"
          - name: country
            data_type: varchar
            description: "País de residencia del usuario"
          - name: city
            data_type: varchar
            description: "Ciudad de residencia del usuario"
          - name: registration_date
            data_type: timestamp_ntz
            description: "Fecha y hora de registro del usuario en el sistema"
            tests:
              - not_null
          - name: last_login_date
            data_type: timestamp_ntz
            description: "Fecha y hora del último acceso del usuario al sistema"
          - name: is_active
            data_type: boolean
            description: "Indicador de si el usuario está activo en el sistema (true/false)"
            tests:
              - not_null
              - accepted_values:
                  values: [true, false]
          - name: user_type
            data_type: varchar
            description: "Tipo de usuario: standard, premium, admin"
            tests:
              - not_null
              - accepted_values:
                  values: ['standard', 'premium', 'admin']
          - name: profile_picture_url
            data_type: varchar
            description: "URL de la imagen de perfil del usuario"
          - name: bio
            data_type: varchar
            description: "Biografía o descripción personal del usuario"
          - name: ingestion_date
            data_type: timestamp_ntz
            description: "Fecha y hora de ingesta del registro en el data warehouse"
            tests:
              - not_null 