version: 2

sources:
  - name: integrationtests
    description: "Data source for integration tests in the development environment"
    database: "ct_maptech_{{env_var('DBT_ENVIRONMENT')}}_silver"
    freshness:
      warn_after: { count: 1, period: day }
      error_after: { count: 2, period: day }
    loaded_at_field: ingestion_date
    tables:
      - name: users
        description: "System users table with personal, contact, and activity information"
        columns:
          - name: user_id
            data_type: number
            description: "Unique user identifier, primary key of the table"
            tests:
              - unique
              - not_null
          - name: username
            data_type: varchar
            description: "Unique username for system authentication"
            tests:
              - not_null
          - name: email
            data_type: varchar
            description: "Users unique email address"
            tests:
              - unique
              - not_null
          - name: first_name
            data_type: varchar
            description: "Users first name"
            tests:
              - not_null
          - name: last_name
            data_type: varchar
            description: "Users last name"
            tests:
              - not_null
          - name: date_of_birth
            data_type: date
            description: "Users date of birth"
          - name: phone_number
            data_type: varchar
            description: "Users phone number"
          - name: country
            data_type: varchar
            description: "Users country of residence"
          - name: city
            data_type: varchar
            description: "Users city of residence"
          - name: registration_date
            data_type: timestamp_ntz
            description: "Date and time when the user registered in the system"
            tests:
              - not_null
          - name: last_login_date
            data_type: timestamp_ntz
            description: "Date and time of the Users last login to the system"
          - name: is_active
            data_type: boolean
            description: "Indicates if the user is active in the system (true/false)"
            tests:
              - not_null
              - accepted_values:
                  values: [true, false]
          - name: user_type
            data_type: varchar
            description: "User type: standard, premium, admin"
            tests:
              - not_null
              - accepted_values:
                  values: ['standard', 'premium', 'admin']
          - name: profile_picture_url
            data_type: varchar
            description: "URL of the Users profile picture"
          - name: bio
            data_type: varchar
            description: "Users biography or personal description"
          - name: ingestion_date
            data_type: timestamp_ntz
            description: "Date and time the record was ingested into the data warehouse"
            tests:
              - not_null